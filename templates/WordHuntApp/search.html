{% extends 'WordHuntApp/base.html' %}
{% load staticfiles %}


{% block title_block %}
	- Search
{% endblock %}

{% block head_block %}
<!-- ALLOW THE SEARCH TOOL TO WORK-->
	<script>
		$(document).ready(function(){
			$("#myInput").on("keyup", function() {
				var value = $(this).val().toLowerCase();
				$("#myTable tr").filter(function() {
					$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
				});
			});
			$(".clickable-row").click(function() {
				window.location = $(this).data("href");
			});
		});
	</script>
	<style>
		a {color: blue;}
		a:visited {color: purple;}
	</style>
{% endblock %}

{% block body_block %}
	<font size=6>Search</font>
	<br />

	<form class="form-inline" action="{% url 'search' %}" method="POST">
		{% csrf_token %}
		{% if query %}
			<input name="query" class="form-control" id="myInput" type="text" class="" value="{{ query }}"/>
		{% else %}
			<input name="query" class="form-control" id="myInput" type="text" class="" placeholder="Search.."/>
		{% endif %}
		<button type="submit" class="btn btn-primary">Search for Users</button>
	</form>
	<br />

	<table class="table table-hover">
		<thead>
			<tr>
				<th style="width: 10%">Rank</th>
				<th>Username</th>
				<th style="width: 20%">Number of Pictures</th>
				<th style="width: 10%">Points</th>
			</tr>
		</thead>
		<tbody id="myTable">
			{% if results %}
				{% for user, n_images in results %}
					<tr class="clickable-row" data-href="{% url 'stats' user %}">
						<td>{{ user.rank }}</td>
						<td><a href="{% url 'stats' user %}">{{ user }}</a></td>
						<td>{{ n_images }}</td>
						<td>{{ user.total_points }}</td>
					</tr>
				{% endfor %}
			{% endif %}
		</tbody>
	</table>

<!-- USING AJAX(?). First check if there is more than 20 users. If yes create a pagination button and when clicked reload user data starting from the next group-->
<!-- TODO: Make this work
	<center>
		<ul class="pagination">
			<li><a href="PART 1">1</a></li>
			<li><a href="PART 2">2</a></li>
			<li><a href="PART 3">3</a></li>
			<li><a href="PART 4">4</a></li>
			<li><a href="PART 5">5</a></li>
		</ul>
	</center>
-->
	<br />
	<a href="{% url 'main' %}">Return to the main page</a> 
{% endblock %}